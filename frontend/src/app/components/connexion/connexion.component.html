<!-- üîê VERSION DESKTOP -->
<div class="hidden md:flex items-center">
  <!-- Si connect√© -->
  <div *ngIf="isConnected()" class="relative ml-3" (keydown.escape)="isMenuOpen = false">
    <div
      class="flex items-center gap-3 bg-white/15 px-5 py-2 rounded-full backdrop-blur-md shadow-sm border border-white/30 cursor-pointer select-none hover:bg-white/25 transition"
      (click)="toggleMenu()"
    >
      <img
        [src]="'https://api.dicebear.com/8.x/initials/svg?seed=' + currentUser()!.prenom + ' ' + currentUser()!.nom"
        alt="Avatar"
        class="w-9 h-9 rounded-full border border-white shadow-sm flex-shrink-0"
      />
      <span class="text-white font-medium text-sm tracking-wide">
        {{ currentUser()!.prenom }} {{ currentUser()!.nom }}
      </span>
      <svg
        class="w-4 h-4 text-white transition-transform duration-200"
        [ngClass]="{ 'rotate-180': isMenuOpen }"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>

    <!-- Menu d√©roulant -->
    <div
      *ngIf="isMenuOpen"
      class="absolute right-0 mt-3 w-48 bg-white rounded-xl shadow-xl border border-gray-200 z-50 origin-top-right animate-fadeIn"
    >
      <div class="absolute -top-2 right-6 w-3 h-3 bg-white rotate-45 border-l border-t border-gray-200"></div>

      <a
          routerLink="/profil"
          (click)="isMenuOpen = false"
          class="menu-link account px-4 py-2 rounded-t-xl flex items-center gap-2"
        >
          <img src="assets/images/connecte.svg" alt="Ic√¥ne utilisateur connect√©" class="w-5 h-5" />
          <span>Mon compte</span>
        </a>

        <button
          (click)="logout(); isMenuOpen = false"
          class="menu-link logout w-full text-left px-4 py-2 rounded-b-xl flex items-center gap-2"
          [disabled]="isLoading()"
        >
          <img src="assets/images/deconnecte.svg" alt="Ic√¥ne d√©connexion" class="w-5 h-5" />
          <span>{{ isLoading() ? 'D√©connexion...' : 'D√©connexion' }}</span>
        </button>

    </div>
  </div>

  <!-- Si pas connect√© -->
  <ng-template #notLogged>
    <button
      routerLink="/login"
      class="btn-login"
    >
      Se Connecter
    </button>
  </ng-template>

  <!-- Afficher si pas connect√© -->
  <button *ngIf="!isConnected()" routerLink="/login" class="btn-login">
    Se Connecter
  </button>
</div>

<!-- üîê VERSION MOBILE -->
<div class="md:hidden w-full">
  <div *ngIf="isConnected()" class="flex flex-col items-center gap-3 mt-3">
    <img
      [src]="'https://api.dicebear.com/8.x/initials/svg?seed=' + currentUser()!.prenom"
      alt="Avatar"
      class="w-12 h-12 rounded-full border border-white shadow-md"
    />
    <p class="text-sm text-gray-100 font-medium uppercase tracking-wide">
      {{ currentUser()!.prenom }} {{ currentUser()!.nom }}
    </p>

    <a
      routerLink="/profil"
      class="bg-white text-indigo-700 font-semibold px-5 py-2 rounded-lg shadow hover:bg-gray-100 transition w-40 text-center"
    >
      Mon compte
    </a>

    <button
      (click)="logout()"
      [disabled]="isLoading()"
      class="bg-red-500 hover:bg-red-600 text-white font-semibold px-5 py-2 rounded-lg shadow transition w-40 disabled:opacity-50"
    >
      {{ isLoading() ? '‚è≥ D√©connexion...' : 'D√©connexion' }}
    </button>
  </div>

  <div *ngIf="!isConnected()" class="flex flex-col items-center gap-3 mt-3">
    <button
      routerLink="/login"
      class="bg-white text-indigo-700 font-semibold px-5 py-2 rounded-lg shadow hover:bg-gray-100 transition w-40"
    >
      Se Connecter
    </button>
    <button
      routerLink="/signup"
      class="text-white/90 hover:text-white underline underline-offset-4"
    >
      Cr√©er un compte
    </button>
  </div>
</div>
